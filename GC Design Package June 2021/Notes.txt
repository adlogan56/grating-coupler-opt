1. S Matrix Simulation: This section simulates individual grating notches and characterizes their transmission, reflection, and scattering coefficients for the target waveguide mode. It only needs to be run once for each particular wavelength and material stack.

1a. Configure filegen_notch_sidewall.lsf (Lumerical script) with grating parameters. All lengths in nanometers.

	h_sub: 		list of thicknesses of flat substrate layers, in order from top to bottom. The last 'layer' has infinite thickess (extends beyond the simulation region), so it is not included in this list. For solid single material substrates, set h_sub = 0.
	n_sub: 		list of refractive indices of flat substrate layers, in the same order as h_sub. The last term in n_sub applies to the 'infinite' bottom layer, so n_sub should have one more element than h_sub.
	h_wg: 		list of thicknesses of waveguide material layers, in order from top to bottom. The waveguides and grating notches are etched through this full stack, so things like diamond ridges should be included even if the material is the same as the underlying substrate. Must contain at least one element. Note that the space in the etched notches and above the waveguide are assumed to be air.
	n_sub: 		list of refractive indices of waveguide layers, in the same order as h_sub. Must be the same length as h_sub.
	sidewall: 	sidewall angle of etched regions (notches and sides of waveguides). 90 is vertical.
	lambda: 	free-space wavelength of light for simulation
	TM: 		polarization of the waveguide mode. 0 for horizontally-polarized TE mode, 1 for vertically-polarized TM mode.
	w_wg: 		width of the waveguide used for the grating coupler. The input laser focus spot should fit on the grating.
	d_gap: 		list of notch widths to simulate. Notches narrower than 50-60 nm may be difficult to fabricate consistently.
	end_type: 	option to simulate the end of the waveguide in addition to the notches.


1b. Run filegen_notch_sidewall.lsf and the Lumerical simulation files it generates.

	notch_path: 	folder to put notch simulation files
	filename_base: 	file name to use for simulation files. The base file name will be modified to include the notch width for each file.
	autoq: 		if 1, the simulation files will be added to the job queue as they are generated
	autorun: 	if 1, the job queue will start running as soon as all of the files are generated


1c. Configure analysis_exp_sidewall.lsf (Lumerical script) to match the generated files. This script extracts the S-matrix parameters (transmission, reflection, scattering) from the individual notch simulations and consolidates them in a .mat file along with other relevant parameters. All lengths in nm

	wavelength:	list of wavelengths that have notches simulated in this material platform
	TM:		mode polarizations for each mode in 'wavelength'. Same as TM in filegen.
	w:		waveguide widths for each mode in 'wavelength' Same as w_wg in filegen.
	WL:		set of modes from 'wavelength' to include in the current analysis. [1] would result in a .mat file for generating single-wavelength gratings for the first mode listed in 'wavelength', and [1,2] would be used to generate multi-wavelength gratings that would simultaneously work for both the first and second mode in 'wavelength'.
	d_gap:		same as in filegen
	end_type:	same as in filegen
	file_base:	same as filename_base in filegen
	path:		same as notch_path in filegen
	base_path:	save location for .mat file containing analysis
	save_file:	filename for .mat file containing analysis


2. Matlab Grating Search: This section searches for grating designs using the analyzed data from the individual notch simulations. All lengths in microns

2a. Configure serialScattererHillClimbOptimize.m (Matlab script)

	param_file:	.mat file generated by analysis_exp_sidewall.lsf
	N_min, N_max:	minimum and maximum number of notches to use for grating designs
	L_min, L_max:	minimum and maximum distance between notches
	s_range:	search range for notch types. 3 means that for each step of the optimization, the script will consider changing each notch to between 3 steps wider and 3 steps narrower.
	L_step:		minimum change to consider for distance between notches
	L_range:	search range for distance between notches, in L_steps
	
	sigma:		FWHM of target gaussian scatter profile. For multi-wavelength gratings, this should be a column vector with values for each mode.
	base_center:	position of center of target gaussian scatter profile, relative to the first grating notch
	var_center:	maximum change applied to base_center for different optimization runs

	num_runs:	number of grating designs to generate


3. Grating Simulation: This section simulates the performance of the generated grating designs using accurate but resource-intensive FDTD. filegen_grating_sidewall.lsf requires some parameters used in earlier files.


	